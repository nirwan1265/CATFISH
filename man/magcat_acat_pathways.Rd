% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/ACAT_wrappers.R
\name{magcat_acat_pathways}
\alias{magcat_acat_pathways}
\title{ACAT pathway test on gene-level p-values}
\usage{
magcat_acat_pathways(
  gene_results,
  pathways = NULL,
  species = NULL,
  pmn_gene_col = NULL,
  gene_col = "GENE",
  p_col = "P",
  min_p = 1e-15,
  do_fix = TRUE,
  output = FALSE,
  out_dir = "magcat_acat"
)
}
\arguments{
\item{gene_results}{data.frame with at least a gene ID column and a
p-value column. For MAGMA \code{.genes.out}, these are commonly
\code{GENE} and \code{P}.}

\item{pathways}{Either:
\itemize{
\item A named list: each element is a character vector of gene IDs
in that pathway, OR
\item A data.frame with columns \code{pathway_id}, \code{gene_id}
(and optional \code{pathway_name}).
}}

\item{species}{Character. One of "maize", "sorghum", "arabidopsis",
"plant", or "fly". If provided, built-in pathways are loaded via
\code{\link{magcat_load_pathways}}. Provide either \code{pathways}
OR \code{species}, but not both.}

\item{pmn_gene_col}{Character or NULL. Passed to
\code{magcat_load_pathways(gene_col=...)} when \code{species} is used.
If NULL, the loader uses default gene column for each species.}

\item{gene_col}{Character. Column name in \code{gene_results} containing
gene IDs. Default \code{"GENE"}.}

\item{p_col}{Character. Column name in \code{gene_results} containing
gene-level p-values. Default \code{"P"}.}

\item{min_p}{Numeric. Lower cap for very small p-values before ACAT.
Default 1e-15.}

\item{do_fix}{Logical. If TRUE (default), clean/cap p-values with
\code{\link{fix_p_for_acat}}.}

\item{output}{Logical. If TRUE, write a CSV of results to \code{out_dir}.}

\item{out_dir}{Character. Directory to write CSV when \code{output = TRUE}.
Default \code{"magcat_acat"}.}
}
\value{
A data.frame with columns:
\describe{
\item{pathway_id}{Pathway identifier}
\item{pathway_name}{Pathway name (if available; otherwise equals
\code{pathway_id})}
\item{n_genes}{Number of genes used in ACAT for this pathway}
\item{gene_names}{Semicolon-separated gene IDs actually used}
\item{acat_p}{ACAT p-value}
}
Rows are sorted by \code{acat_p} in increasing order (smallest p first;
NA at bottom). If \code{output = TRUE}, an attribute \code{"file"} is
attached with the CSV path.
}
\description{
Computes a self-contained pathway p-value per gene set by combining the
member gene p-values using ACAT (Cauchy combination).
}
\details{
Gene IDs are matched case-insensitively: both \code{gene_results[[gene_col]]}
and pathway gene IDs are normalized to lower-case before matching. Genes
that do not appear in \code{gene_results} are dropped for that pathway.
}
\examples{
\dontrun{
# Load gene results from MAGMA output
gene_results <- read.delim("magma_output.genes.out")

# Run ACAT on maize PMN pathways
acat_res <- magcat_acat_pathways(
  gene_results = gene_results,
  species = "maize",
  gene_col = "GENE",
  p_col = "P"
)
head(acat_res)

# Run with custom pathways
my_pathways <- list(
  pathway1 = c("gene1", "gene2", "gene3"),
  pathway2 = c("gene4", "gene5")
)
acat_custom <- magcat_acat_pathways(
  gene_results = gene_results,
  pathways = my_pathways
)
}

}
\seealso{
\code{\link{magcat_load_pathways}} for loading pathway definitions

\code{\link{magcat_fisher_pathways}}, \code{\link{magcat_minp_pathways}},
\code{\link{magcat_omni2_pathways}} for other p-value combination methods
}
